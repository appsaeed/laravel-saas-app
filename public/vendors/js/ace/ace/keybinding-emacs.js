ace.define("ace/keyboard/emacs",["require","exports","module","ace/lib/dom","ace/keyboard/hash_handler","ace/lib/keys"],(function(e,t,n){var o=e("../lib/dom"),a=function(e,t){var n=this.scroller.getBoundingClientRect(),a=Math.floor((e+this.scrollLeft-n.left-this.$padding-o.getPageScrollLeft())/this.characterWidth),i=Math.floor((t+this.scrollTop-n.top-o.getPageScrollTop())/this.lineHeight);return this.session.screenToDocumentPosition(i,a)},i=e("./hash_handler").HashHandler;t.handler=new i;var r=!1;t.handler.attach=function(e){r||(r=!0,o.importCssString("            .emacs-mode .ace_cursor{                border: 2px rgba(50,250,50,0.8) solid!important;                -moz-box-sizing: border-box!important;                -webkit-box-sizing: border-box!important;                box-sizing: border-box!important;                background-color: rgba(0,250,0,0.9);                opacity: 0.5;            }            .emacs-mode .ace_cursor.ace_hidden{                opacity: 1;                background-color: transparent;            }            .emacs-mode .ace_overwrite-cursors .ace_cursor {                opacity: 1;                background-color: transparent;                border-width: 0 0 2px 2px !important;            }            .emacs-mode .ace_text-layer {                z-index: 4            }            .emacs-mode .ace_cursor-layer {                z-index: 2            }","emacsMode")),e.renderer.screenToTextCoordinates=a,e.setStyle("emacs-mode")},t.handler.detach=function(e){delete e.renderer.screenToTextCoordinates,e.unsetStyle("emacs-mode")};var l=e("../lib/keys").KEY_MODS,s={C:"ctrl",S:"shift",M:"alt"};["S-C-M","S-C","S-M","C-M","S","C","M"].forEach((function(e){var t=0;e.split("-").forEach((function(e){t|=l[s[e]]})),s[t]=e.toLowerCase()+"-"})),t.handler.bindKey=function(e,t){if(e){var n=this.commmandKeyBinding;e.split("|").forEach((function(e){e=e.toLowerCase(),n[e]=t,e=e.split(" ")[0],n[e]||(n[e]="null")}),this)}},t.handler.handleKeyboard=function(e,t,n,o){if(-1==t&&e.count){var a=Array(e.count+1).join(n);return e.count=null,{command:"insertstring",args:a}}if("\0"!=n){var i=s[t];if("c-"==i||e.universalArgument)if(c=parseInt(n[n.length-1]))return e.count=c,{command:"null"};e.universalArgument=!1,i&&(n=i+n),e.keyChain&&(n=e.keyChain+=" "+n);var r=this.commmandKeyBinding[n];if(e.keyChain="null"==r?n:"",r){if("null"==r)return{command:"null"};if("universalArgument"==r)return e.universalArgument=!0,{command:"null"};if("string"!=typeof r){var l=r.args;r=r.command}if("string"==typeof r&&(r=this.commands[r]||e.editor.commands.commands[r]),!r.readonly&&!r.isYank&&(e.lastCommand=null),e.count){var c=e.count;return e.count=0,{args:l,command:{exec:function(e,t){for(var n=0;n<c;n++)r.exec(e,t)}}}}return{command:r,args:l}}}},t.emacsKeys={"Up|C-p":"golineup","Down|C-n":"golinedown","Left|C-b":"gotoleft","Right|C-f":"gotoright","C-Left|M-b":"gotowordleft","C-Right|M-f":"gotowordright","Home|C-a":"gotolinestart","End|C-e":"gotolineend","C-Home|S-M-,":"gotostart","C-End|S-M-.":"gotoend","S-Up|S-C-p":"selectup","S-Down|S-C-n":"selectdown","S-Left|S-C-b":"selectleft","S-Right|S-C-f":"selectright","S-C-Left|S-M-b":"selectwordleft","S-C-Right|S-M-f":"selectwordright","S-Home|S-C-a":"selecttolinestart","S-End|S-C-e":"selecttolineend","S-C-Home":"selecttostart","S-C-End":"selecttoend","C-l":"recenterTopBottom","M-s":"centerselection","M-g":"gotoline","C-x C-p":"selectall","C-Down":"gotopagedown","C-Up":"gotopageup","PageDown|C-v":"gotopagedown","PageUp|M-v":"gotopageup","S-C-Down":"selectpagedown","S-C-Up":"selectpageup","C-s":"findnext","C-r":"findprevious","M-C-s":"findnext","M-C-r":"findprevious","S-M-5":"replace",Backspace:"backspace","Delete|C-d":"del","Return|C-m":{command:"insertstring",args:"\n"},"C-o":"splitline","M-d|C-Delete":{command:"killWord",args:"right"},"C-Backspace|M-Backspace|M-Delete":{command:"killWord",args:"left"},"C-k":"killLine","C-y|S-Delete":"yank","M-y":"yankRotate","C-g":"keyboardQuit","C-w":"killRegion","M-w":"killRingSave","C-Space":"setMark","C-x C-x":"exchangePointAndMark","C-t":"transposeletters","M-u":"touppercase","M-l":"tolowercase","M-/":"autocomplete","C-u":"universalArgument","M-;":"togglecomment","C-/|C-x u|S-C--|C-z":"undo","S-C-/|S-C-x u|C--|S-C-z":"redo","C-x r":"selectRectangularRegion"},t.handler.bindKeys(t.emacsKeys),t.handler.addCommands({recenterTopBottom:function(e){var t=e.renderer,n=t.$cursorLayer.getPixelPosition(),o=t.$size.scrollerHeight-t.lineHeight,a=t.scrollTop;a=Math.abs(n.top-a)<2?n.top-o:Math.abs(n.top-a-.5*o)<2?n.top:n.top-.5*o,e.session.setScrollTop(a)},selectRectangularRegion:function(e){e.multiSelect.toggleBlockSelection()},setMark:function(){},exchangePointAndMark:{exec:function(e){var t=e.selection.getRange();e.selection.setSelectionRange(t,!e.selection.isBackwards())},readonly:!0,multiselectAction:"forEach"},killWord:{exec:function(e,n){e.clearSelection(),"left"==n?e.selection.selectWordLeft():e.selection.selectWordRight();var o=e.getSelectionRange(),a=e.session.getTextRange(o);t.killRing.add(a),e.session.remove(o),e.clearSelection()},multiselectAction:"forEach"},killLine:function(e){e.selection.selectLine();var n=e.getSelectionRange(),o=e.session.getTextRange(n);t.killRing.add(o),e.session.remove(n),e.clearSelection()},yank:function(e){e.onPaste(t.killRing.get()),e.keyBinding.$data.lastCommand="yank"},yankRotate:function(e){"yank"==e.keyBinding.$data.lastCommand&&(e.undo(),e.onPaste(t.killRing.rotate()),e.keyBinding.$data.lastCommand="yank")},killRegion:function(e){t.killRing.add(e.getCopyText()),e.commands.byName.cut.exec(e)},killRingSave:function(e){t.killRing.add(e.getCopyText())}});var c=t.handler.commands;c.yank.isYank=!0,c.yankRotate.isYank=!0,t.killRing={$data:[],add:function(e){e&&this.$data.push(e),this.$data.length>30&&this.$data.shift()},get:function(){return this.$data[this.$data.length-1]||""},pop:function(){return this.$data.length>1&&this.$data.pop(),this.get()},rotate:function(){return this.$data.unshift(this.$data.pop()),this.get()}}}));
